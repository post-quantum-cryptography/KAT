## KAT for FIPS-204

Compliant with FIPS-204, published on August 13, 2024.

## File format:

There are six sets of KAT tests for each security level. They are split into 2 subgroup - signing mode and implementation flavour.

Signing Modes:
* ``hedged`` : the ρ′ is pseudorandomly derived from the signer’s private key, the message,
and a 256-bit string, ``rnd``, which by default should be generated at random.
* ``deterministic``: same as above, but the ``rnd`` buffer is filled with zeros.

Implementation Flavours:
---
* ``raw`` : Vectors generated by {Keygen, Sign, Verify}_internal functions (Algorithms 6,7,8)
* ``pure``: Vectors generated by Keygen, Sign and Verify (Algorithms 1,2,3)
* ``hashed``: Vectors generated by Keygen, HashML-DSA.Sign and HashML-DSA.Verify (Algorithms 1,4,5). In this case the message is pre-hashed before signing. The hash function used for pre-hashing depends on lambda parameter (see section 5.4 of FIPS-204). We use SHA2-256 for MLDSA-44, SHA2-384 for MLDSA-65 and SHA2-512 for MLDSA-87.


KAT test values:
---
| Field     | Meaning                                                              |
|-----------|----------------------------------------------------------------------|
| ``xi``    | Seed value ``xi`` generated by Algorithm 1 (line 1)                  |
| ``rng``   | Seed value ``rnd`` generated by Algorithm 2 (line 5). Only hedged case|
| ``count`` | Test number                                                          |
| ``mlen``  | Length of the ``msg``                                                |
| ``msg``   | Message to sign                                                      |
| ``pk``    | Resulting public key                                                 |
| ``sk``    | Resulting secret key                                                 |
| ``sm``    | Resulting signature concatenated with the message (``sm`` | ``msg``) |
| ``smlen`` | Length of the ``sm`` buffer                                          |
| ``ctx``   | The context string. Always 16 bytes.                                 |
| ``seed``  | AES-CTR-drbg seed (only needed to re-generate KATs)                  |

## How it was generated

We use DRBG based on based on AES-CTR (see [SP800-90A](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf)) for generating random bytes. For each KAT vector, the DRBG is seeded with the ``seed`` value (personalisation string is not used). The test first generates a secret and public key. Then it encapsulates and decapsulates the shared secret.
